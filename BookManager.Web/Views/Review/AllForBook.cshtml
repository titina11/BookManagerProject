@model IEnumerable<BookManager.ViewModels.Review.ReviewViewModel>

@{
	ViewData["Title"] = "Рецензии за книгата";
	var bookId = ViewBag.BookId as Guid?;
	var currentUserEmail = User.Identity?.Name;
	var isAdmin = User.IsInRole("Admin");
}

<h2 class="mt-4">Рецензии</h2>

<a asp-controller="Review" asp-action="Create" asp-route-bookId="@bookId" class="btn btn-success mb-3">Добави рецензия</a>

@if (!Model.Any())
{
	<p>Няма добавени рецензии за тази книга.</p>
}
else
{
	<div class="list-group mt-3">
		@foreach (var review in Model)
		{
			<div class="list-group-item d-flex justify-content-between align-items-start">
				<div>
					<p><strong>@review.UserEmail</strong></p>
					<p>@review.Content</p>
					<p><em>Оценка: @review.Rating</em></p>
				</div>

				@if (review.UserEmail == currentUserEmail || isAdmin)
				{
					<div class="text-end">
						<a asp-controller="Review" asp-action="Edit" asp-route-id="@review.Id" class="btn btn-sm btn-primary me-1">Редактирай</a>
						<a asp-controller="Review" asp-action="Delete" asp-route-id="@review.Id" class="btn btn-sm btn-danger">Изтрий</a>
					</div>
				}
			</div>
		}
	</div>
}

<a asp-action="All" asp-controller="Book" class="btn btn-secondary">Назад</a>


